#!/bin/sh
#  Installs ani entire Linix desktop environment into $HOME directory
#  uses the following GitHub repos as submodules:
#
#    grscheller/home
#    grscheller/fish
#    grscheller/nvim
#    grscheller/sway
#

export scriptName=dfInstall

XDG_CONFIG_HOME="${XDG_CONFIG_HOME:=$HOME/.config}"
DOTFILE_GIT_REPO="${DOTFILE_GIT_REPO:=$HOME/devel/dotfiles}"
umask 0022

## Source install infrastructure
switch=''
. ./installSource.sh

## Files to install

CONFIG_FILES='
   git/config
'

RM_TARGET_ITEMS="
   $HOME/.gitconfig
"

DIRS_TO_CREATE=""

## Install or Check

# Install via git submodules
(FISH_GIT_REPO="${DOTFILE_GIT_REPO}/config/fish"; . ./config/fish/fishInstall) &
(NVIM_GIT_REPO="${DOTFILE_GIT_REPO}/config/nvim"; . ./config/nvim/nvInstall) &
(HOME_GIT_REPO="${DOTFILE_GIT_REPO}/home"; . ./home/homeInstall) &
(SWAY_GIT_REPO="${DOTFILE_GIT_REPO}/sway"; . ./sway/swayInstall) &

# Install miscellaneous $XDG_CONFIG_HOME configuration files
for file in $CONFIG_FILES
do
   install_file "$XDG_CONFIG_HOME" "$file" ./config 0644 "$switch"
done
chmod 0755 "$XDG_CONFIG_HOME"

# Remove/report no longer needed files and directories
for item in $RM_TARGET_ITEMS
do
   remove_item "$item" target
done

# Create or report on missing directories
for DIR in $DIRS_TO_CREATE
do
   ensure_dir "$DIR"
done

# Final adjustments/tweaks/tasks
case "$switch" in
   install)
      :
      ;;
   repo)
      # Get git status info on repo
      printf '\nGit Status:\n'
      git status -s
      ;;
   target)
      :
      ;;
esac
